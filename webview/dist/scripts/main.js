var home=function(t,e,a){"use strict";var o={init:function(){this.startDemo()},startDemo:function(){var t=this,e={flightNo:70,airlineCode:"AC",departure:"2015-06-02T12:00",arrival:"2015-06-02T13:45",boarding:"2015-06-02T11:40",startingAirport:"BOS",destinationAirport:"YYZ",startingCity:"Boston",destinationCity:"Toronto",flightStatus:"On Time",startingGate:1,destinationGate:1,coupon:null},a={flightNo:70,airlineCode:"AC",departure:"2015-06-02T12:00",arrival:"2015-06-02T13:45",boarding:"2015-06-02T11:40",startingAirport:"BOS",destinationAirport:"YYZ",startingCity:"Boston",destinationCity:"Toronto",flightStatus:"Delayed",startingGate:1,destinationGate:1,coupon:{id:0,company:"Starbucks",companyCode:"STBK",path:"images/starbucks-coupon.png",offer:"Get 1 Free Starbucks Coffee",description:"Redeem this coupon at any Starbucks Coffee location at Boston Logan International.",delaySeverity:60,statusId:2}};"delayed"===this.getQueryString("flight")?this.getFlightData(4).done(function(e){t.flightData=e,t.updateView()}).fail(function(e,o,i){t.flightData=a,t.updateView(),console.log(i)}):this.getFlightData(0).done(function(e){t.flightData=e,t.updateView()}).fail(function(a,o,i){t.flightData=e,t.updateView(),console.log(i)}),t.createCouponStorage()},setDemoMode:function(e,a,o){var i=this;setTimeout(function(){i.getFlightData(e).done(function(e){i.flightData=e,t(".current-flight").children().not("#current-flight-tmpl").remove(),i.updateView(),localStorage.setItem(a,"false"),localStorage.setItem(o,"true")}).fail(function(e,n,l){i.flightData=backupDelayedData,t(".current-flight").children().not("#current-flight-tmpl").remove(),i.updateView(),localStorage.setItem(a,"false"),localStorage.setItem(o,"true"),console.log(l)})},5e3)},updateView:function(){this.parseDepartureTime(),this.compileHandlebarsTemplate(),this.checkFlightStatus(),localStorage.setItem("flightData",JSON.stringify(this.flightData))},getFlightData:function(e){var a="http://redhatairportdemo-fguanlao.rhcloud.com/rest/flightStatus/70?demoMode="+e;return t.ajax({url:a,method:"GET"})},compileHandlebarsTemplate:function(){var e=t("#current-flight-tmpl").html(),a=Handlebars.compile(e),o=a(this.flightData);t(".current-flight").append(o)},parseDepartureTime:function(){this.flightData.departureTime=moment(this.flightData.departure).calendar(new Date)},checkFlightStatus:function(){var e=t(".current-flight-departure"),a=t(".current-flight-status");"On Time"===this.flightData.flightStatus?(e.addClass("success-color"),a.addClass("success-bg")):"Delayed"===this.flightData.flightStatus?(e.addClass("failure-color"),a.addClass("failure-bg"),a.addClass("failure-bg-get-coupon"),a.parent().append('<div class="get-coupon">Get Coupon</div>')):"Changed"===this.flightData.flightStatus&&(e.addClass("failure-color"),a.addClass("failure-bg"))},createCouponStorage:function(){localStorage.getItem("coupons")||localStorage.setItem("coupons",JSON.stringify([]))},getQueryString:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)"),a=e.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}};return o}(jQuery,window,document),flightDetails=function(t,e,a){"use strict";var o={init:function(){this.flightData=this.getFlightData(),this.parseFlightDate(),this.parseFlightTimes(),this.compileHandlebarsTemplate(),this.checkFlightStatus(),this.checkCouponStatus(),this.saveCouponButtonListener()},getFlightData:function(){var t=JSON.parse(localStorage.getItem("flightData"));return t},compileHandlebarsTemplate:function(){var e=t("#flight-details-tmpl").html(),a=Handlebars.compile(e),o=a(this.flightData);t(".main-container").append(o)},parseFlightDate:function(){this.flightData.flightDate=moment(this.flightData.departure).format("ddd, MMM DD YYYY")},parseFlightTimes:function(){this.flightData.departureTime=moment(this.flightData.departure).format("HH:mm"),this.flightData.arrivalTime=moment(this.flightData.arrival).format("HH:mm"),this.flightData.boardingTime=moment(this.flightData.boarding).format("HH:mm")},checkFlightStatus:function(){var e=t(".flight-status");"On Time"===this.flightData.flightStatus?e.addClass("success-bg"):"Delayed"===this.flightData.flightStatus?e.addClass("failure-bg"):"Changed"===this.flightData.flightStatus&&e.addClass("failure-bg")},checkCouponStatus:function(){var e=t(".coupon-saved-area"),a=t(".coupon-area"),o=JSON.parse(localStorage.getItem("coupons"))||"";o.length?(a.hide(),e.show()):(a.show(),e.hide())},saveCouponButtonListener:function(){var e=this,a=t(".coupon-save-btn"),o=t(".coupon-saved-area"),i=t(".coupon-area");a.on("click",function(){var t=JSON.parse(localStorage.getItem("coupons"));i.hide(),o.show(),t.push(e.flightData),localStorage.setItem("coupons",JSON.stringify(t))})}};return o}(jQuery,window,document),couponList=function(t,e,a){"use strict";var o={init:function(){this.couponData={},this.couponData.coupons=JSON.parse(localStorage.getItem("coupons"))||"",this.compileHandlebarsTemplate()},compileHandlebarsTemplate:function(){var e=t("#coupon-list-tmpl").html(),a=Handlebars.compile(e),o=a(this.couponData);t(".coupon-list-container").append(o)}};return o}(jQuery,window,document),couponDetails=function(t,e,a){"use strict";var o={init:function(){this.couponData=JSON.parse(localStorage.getItem("coupons"))||"",this.getCouponDetails(),this.parseFlightDate(),this.compileHandlebarsTemplate()},getCouponDetails:function(){var t=parseInt(home.getQueryString("id"));this.couponDetails=this.couponData[t]},parseFlightDate:function(){this.couponDetails.flightDate=moment(this.couponDetails.departure).format("ddd, MMM DD YYYY")},compileHandlebarsTemplate:function(){var e=t("#coupon-details-tmpl").html(),a=Handlebars.compile(e),o=a(this.couponDetails);t(".coupon-details-container").append(o)}};return o}(jQuery,window,document),admin=function(t,e,a){"use strict";var o={init:function(){this.resetButtonListener(),this.flightOnTimeButtonListener(),this.flightDelayedButtonListener(),this.flightLateButtonListener(),this.beaconOnTimeListener(),this.beaconDelayedListener(),this.beaconChangedListener(),this.stopBeaconButtonListener()},resetButtonListener:function(){t(".reset-btn").on("click",function(){localStorage.clear(),alert("Demo has been reset")})},flightOnTimeButtonListener:function(){t(".flight-ontime-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/flightStatus/70?demoMode=3",method:"GET"}).done(function(){alert("On time flight on"),e.location.href="/index.html?flight=ontime"}).fail(function(t,e,a){alert("On time flight failed"),console.log(a)})})},flightDelayedButtonListener:function(){t(".flight-delayed-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/flightStatus/70?demoMode=2",method:"GET"}).done(function(){alert("Delayed flight on"),e.location.href="/index.html?flight=delayed"}).fail(function(t,e,a){alert("Delayed flight failed"),console.log(a)})})},flightLateButtonListener:function(){t(".flight-late-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/flightStatus/70?demoMode=1",method:"GET"}).done(function(){alert("Running late on"),e.location.href="/index.html?flight=ontime"}).fail(function(t,e,a){alert("Running late failed"),console.log(a)})})},beaconOnTimeListener:function(){t(".beacon-ontime-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/digitalSignage",data:{showDetails:3},method:"POST"}).done(function(){alert("Beacon on time started")}).fail(function(t,e,a){alert("Beacon on time failed"),console.log(a)})})},beaconDelayedListener:function(){t(".beacon-delayed-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/digitalSignage",data:{showDetails:2},method:"POST"}).done(function(){alert("Beacon delayed started")}).fail(function(t,e,a){alert("Beacon delayed failed"),console.log(a)})})},beaconChangedListener:function(){t(".beacon-changed-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/digitalSignage",data:{showDetails:1},method:"POST"}).done(function(){alert("Beacon changed started")}).fail(function(t,e,a){alert("Beacon changed failed"),console.log(a)})})},stopBeaconButtonListener:function(){t(".beacon-stop-btn").on("click",function(){t.ajax({url:"http://redhatairportdemo-fguanlao.rhcloud.com/rest/digitalSignage",data:{showDetails:0},method:"POST"}).done(function(){alert("Beacon stopped")}).fail(function(t,e,a){alert("Beacon stop failed"),console.log(a)})})}};return o}(jQuery,window,document);